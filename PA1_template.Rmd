---
output:
  html_document:
    keep_md: yes
---
# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
Read data from csv file.
```{r read_data}
raw_data = read.csv("data/activity.csv")
summary(raw_data)
```
Remove NA

```{r remove_na}
data = raw_data[complete.cases(raw_data),]
summary(data)
```

## What is mean total number of steps taken per day?

1) Histogram of the total number of steps taken each day
```{r hist_steps_daily}
steps_daily = aggregate(steps ~ date, data=data, sum)
hist(steps_daily$steps, xlab = "steps", main="Total number of steps each day")
```

2) Mean and median total number of steps taken per day
```{r steps_mean_median}
mean(steps_daily$steps)
median(steps_daily$steps)
```

## What is the average daily activity pattern?
ÃŸ
1) Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

```{r avg_steps_daily}
# Calculate mean across date
avg_steps_daily = aggregate(steps ~ date, data=data, mean)

# Calculate max steps
max_step = max(avg_steps_daily$steps)
max_idx = which(avg_steps_daily$steps == max_step)

require('xts')
# Convert to time serie object
avg_steps_daily = xts(avg_steps_daily[]["steps"], as.Date(avg_steps_daily$date, format='%Y-%m-%d'))
data_plot = data.frame(
    "date" = index(avg_steps_daily),
    "steps" = avg_steps_daily$steps
    )

require("ggplot2")
ggplot(data = data_plot) + 
  geom_line(aes(x = date, y = steps)) + xlab("") + ylab("Avg steps")                                          
```

2) Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
avg_steps_daily[max_idx,]
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
